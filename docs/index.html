<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@xarc/module-dev</title>
	<meta name="description" content="Documentation for @xarc/module-dev">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@xarc/module-dev</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>@xarc/module-dev</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#nodejs-modules-development-support" id="nodejs-modules-development-support" style="color: inherit; text-decoration: none;">
					<h1>node.js modules development support</h1>
				</a>
				<p>This module offers common config and setup for developing a node.js module.</p>
				<p>Support for standard tools include:</p>
				<ul>
					<li>Language: <a href="https://www.typescriptlang.org/">TypeScript</a></li>
					<li>Testing and code coverage: <a href="https://www.chaijs.com/">chai</a>, <a href="https://mochajs.org/">mocha</a>, <a href="https://istanbul.js.org/">nyc</a>, <a href="https://sinonjs.org/">sinon</a>, <a href="https://www.npmjs.com/package/tap">tap</a>, <a href="https://jestjs.io/">jest</a></li>
					<li>Code linting: <a href="https://eslint.org/">eslint</a></li>
					<li>Documentation: <a href="https://jsdoc.app/">jsdoc</a>, <a href="https://typedoc.org/">typedoc</a></li>
				</ul>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<p>To start a new module, first create the directory for it:</p>
				<pre><code class="language-sh"><span style="color: #000000">mkdir my-module</span>
<span style="color: #795E26">cd</span><span style="color: #000000"> my-module</span>
</code></pre>
				<p>Then follow the instructions below to setup development:</p>
				<ol>
					<li>Within your new project dir, run:</li>
				</ol>
				<pre><code class="language-sh"><span style="color: #000000">npm init --yes</span>
<span style="color: #000000">npm install --save-dev @xarc/module-dev</span>
</code></pre>
				<ol start="2">
					<li>Bootstrap: then to bootstrap your project, use the following commands:</li>
				</ol>
				<pre><code class="language-sh"><span style="color: #000000">npx xrun --require @xarc/module-dev init</span>
<span style="color: #000000">npm install</span>
</code></pre>
				<ul>
					<li><p><code>init</code> takes the following options. ie: <code>npx xrun --require @xarc/module-dev init --eslint</code></p>
						<ul>
							<li><code>--no-typescript</code> - bootstrap without typescript support.</li>
							<li><code>--eslint</code> - bootstrap with eslint support.</li>
						</ul>
					</li>
				</ul>
				<ol start="3">
					<li>Now you can run <code>npx xrun</code> to see a list of build tasks available for developing your node.js module.</li>
				</ol>
				<a href="#xarcrun-cli" id="xarcrun-cli" style="color: inherit; text-decoration: none;">
					<h3>@xarc/run-cli</h3>
				</a>
				<p>If you want to be able to run <code>xrun</code> directly instead of having to do <code>npx xrun</code>, then you can install globally a simple package <a href="https://www.npmjs.com/package/@xarc/run-cli">@xarc/run-cli</a> with the following command.</p>
				<pre><code class="language-sh"><span style="color: #000000">$ npm install -g @xarc/run-cli</span>
</code></pre>
				<a href="#project-structure" id="project-structure" style="color: inherit; text-decoration: none;">
					<h2>Project Structure</h2>
				</a>
				<p>This module&#39;s setup assumes your project follows a directory structure like below:</p>
				<pre><code><span style="color: #000000">.</span><span style="color: #001080">gitignore</span>
<span style="color: #001080">package</span><span style="color: #000000">.</span><span style="color: #001080">json</span>
<span style="color: #001080">tsconfig</span><span style="color: #000000">.</span><span style="color: #001080">json</span>

<span style="color: #001080">lib</span><span style="color: #000000">/</span>
<span style="color: #000000">  </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">js</span>

<span style="color: #001080">dist</span><span style="color: #000000">/</span>
<span style="color: #000000">  </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">js</span>
<span style="color: #000000">  </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">d</span><span style="color: #000000">.</span><span style="color: #001080">js</span>
<span style="color: #000000">  </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">.</span><span style="color: #001080">map</span>

<span style="color: #001080">src</span><span style="color: #000000">/</span>
<span style="color: #000000">  </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">ts</span>

<span style="color: #001080">test</span><span style="color: #000000">/</span>
<span style="color: #000000">  </span><span style="color: #001080">spec</span><span style="color: #008000">/**</span>
<span style="color: #008000">    *.spec.js</span>
<span style="color: #008000">    *.spec.ts</span>
</code></pre>
				<p>If you are writing JavaScript that node.js can execute directly, then you can put them in <code>lib</code> dir.</p>
				<p>If you are using TypeScript, then you can put your <code>ts</code> source in <code>src</code> dir, and then run <code>npx tsc</code> to compile them into the <code>dist</code> dir.</p>
				<p><code>.d.ts</code> type definition files and source map files will also be generated into the <code>dist</code> dir.</p>
				<a href="#developing" id="developing" style="color: inherit; text-decoration: none;">
					<h2>Developing</h2>
				</a>
				<p>Once you start writing your code, either as <a href="https://www.typescriptlang.org/">TypeScript</a> in <code>src</code> or JavaScript in <code>lib</code>, you should put your tests in the directory <code>test/spec</code> as <code>*.spec.js</code> or <code>*.spec.ts</code> files.</p>
				<p>The following are common build tasks that you would use:</p>
				<ul>
					<li>Run linting and tests: <code>npx xrun test</code></li>
					<li>Run tests without linting: <code>npx xrun test-only</code></li>
					<li>Run linting and tests with coverage: <code>npx xrun check</code></li>
				</ul>
				<p>Your <a href="https://www.typescriptlang.org/">TypeScript</a> tests should import your TS code from <code>src</code> directly.</p>
				<a href="#publishing" id="publishing" style="color: inherit; text-decoration: none;">
					<h2>Publishing</h2>
				</a>
				<p>When you are ready to publish your module to <a href="https://www.npmjs.com/">npm</a>, please keep the following in mind:</p>
				<p>This module automatically setup <a href="https://docs.npmjs.com/files/package.json#files">files</a> in your <code>package.json</code> to include these files to publish:</p>
				<ul>
					<li><code>lib</code> - If you have JavaScript in <code>lib</code> dir</li>
					<li><code>dist</code> - If you are writing your code in <a href="https://www.typescriptlang.org/">TypeScript</a>.</li>
				</ul>
				<p>For <a href="https://www.typescriptlang.org/">TypeScript</a>, your code from <code>src</code> directory is not included. If you want to include <code>src</code> dir, please add that to <a href="https://docs.npmjs.com/files/package.json#files">files</a>.</p>
				<ul>
					<li>If you have any other files or dirs that you want to publish, then add them to the <code>files</code> list.</li>
					<li>You can run <code>npm publish --dry-run</code> to see what <a href="https://www.npmjs.com/">npm</a> will do without actually publishing for real.</li>
					<li>When you are ready to publish for real, you can run <code>npm publish</code>.</li>
				</ul>
				<a href="#typescript-support" id="typescript-support" style="color: inherit; text-decoration: none;">
					<h2><a href="https://www.typescriptlang.org/">TypeScript</a> Support</h2>
				</a>
				<p>If you boostrapped your project without <a href="https://www.typescriptlang.org/">TypeScript</a>, but then want to add it later, you can run the <code>typescript</code> build task any time:</p>
				<pre><code class="language-sh"><span style="color: #000000">npx xrun typescript</span>
<span style="color: #000000">npm install</span>
<span style="color: #000000">mkdir src</span>
</code></pre>
				<p>And now you can start writing typescript code in the <code>src</code> directory</p>
				<a href="#tsconfigjson" id="tsconfigjson" style="color: inherit; text-decoration: none;">
					<h3>tsconfig.json</h3>
				</a>
				<p>After this module created <code>tsconfig.json</code> for you, you can change it as you like. This module won&#39;t override your settings.</p>
				<a href="#esmoduleinterop" id="esmoduleinterop" style="color: inherit; text-decoration: none;">
					<h4><code>esModuleInterop</code></h4>
				</a>
				<p>The default <code>tsconfig.json</code> will set <code>esModuleInterop</code> to <code>true</code> for you so you can import classic modules directly
				like <code>import Path from &quot;path&quot;</code>. Set it to <code>false</code> if you don&#39;t want this.</p>
				<a href="#tslib-and-importhelpers" id="tslib-and-importhelpers" style="color: inherit; text-decoration: none;">
					<h4><code>tslib</code> and <code>importHelpers</code></h4>
				</a>
				<p><code>tslib</code> is automatically added to your module&#39;s <code>dependencies</code> and <code>importHelpers</code> set to <code>true</code> in your <code>tsconfig.json</code>. If this is not needed or wanted, then feel free to remove them. They won&#39;t be touched again.</p>
				<a href="#eslint-support" id="eslint-support" style="color: inherit; text-decoration: none;">
					<h2><a href="https://eslint.org/">eslint</a> Support</h2>
				</a>
				<p>If you didn&#39;t bootstrap your project with <a href="https://eslint.org/">eslint</a> support, you can always add it later by running <code>npx xrun eslint</code>, and then <code>npm install</code>.</p>
				<p>You need to create a <code>.eslintrc.js</code> file. If you want to use the eslint config this module setup, set it to:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">eslintRcNodeTypeScript</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;.&quot;</span><span style="color: #000000">);</span>
<span style="color: #267F99">module</span><span style="color: #000000">.</span><span style="color: #267F99">exports</span><span style="color: #000000"> = {</span>
<span style="color: #000000">  </span><span style="color: #001080">extends:</span><span style="color: #000000"> </span><span style="color: #001080">eslintRcNodeTypeScript</span><span style="color: #000000">,</span>
<span style="color: #000000">};</span>
</code></pre>
				<p>The configs available are:</p>
				<ul>
					<li><code>eslintRcNode</code> - Node.js</li>
					<li><code>eslintRcNodeTypeScript</code> - Node.js for typescript</li>
					<li><code>eslintRcTest</code> - Unit test code</li>
					<li><code>eslintRcTestTypeScript</code> - typescript unit test code</li>
				</ul>
				<p>You can invoke the linting task with <code>npx xrun lint</code></p>
				<p>The build task <code>check</code> will run linting also. You can invoke it with <code>npx xrun check</code>.</p>
				<p>If you need to disable certain eslint rules for a specific source file, you can add the following comment to the top of your file.</p>
				<pre><code class="language-js"><span style="color: #008000">/* eslint-disable no-console, no-magic-numbers, max-statements */</span>
</code></pre>
				<p>This comment disables the following three rules:</p>
				<ul>
					<li><code>no-console</code></li>
					<li><code>no-magic-numbers</code></li>
					<li><code>max-statements</code></li>
				</ul>
				<a href="#jsdoc-linting" id="jsdoc-linting" style="color: inherit; text-decoration: none;">
					<h2><a href="https://jsdoc.app/">jsdoc</a> linting</h2>
				</a>
				<p>If you&#39;ve enabled <a href="https://eslint.org/">eslint</a>, then linting rules for <a href="https://jsdoc.app/">jsdoc</a> is added with the plugin <a href="https://www.npmjs.com/package/eslint-plugin-jsdoc">eslint-plugin-jsdoc</a>.</p>
				<a href="#typedoc-support" id="typedoc-support" style="color: inherit; text-decoration: none;">
					<h2><a href="https://typedoc.org/">typedoc</a> Support</h2>
				</a>
				<p>If you&#39;ve enabled <a href="https://www.typescriptlang.org/">TypeScript</a>, then <a href="https://typedoc.org/">typedoc</a> is added to automatically generate HTML in <code>docs</code> from your <a href="https://jsdoc.app/">jsdoc</a> in your code in the <code>src</code> directory.</p>
				<p>To generate the docs manually, run <code>npm run docs</code>. And then open <code>docs/index.html</code> to see the generated HTML docs.</p>
				<a href="#fix-typedoc-externals" id="fix-typedoc-externals" style="color: inherit; text-decoration: none;">
					<h3>Fix <a href="https://typedoc.org/">typedoc</a> externals</h3>
				</a>
				<p><a href="https://typedoc.org/">typedoc</a> treats every filenames as a module and that doesn&#39;t work well with the practice of one class per file.</p>
				<p>To customize modules for <a href="https://typedoc.org/">typedoc</a>, install the module <code>typedoc-plugin-external-module-name</code>.</p>
				<p>Then in the <code>.ts</code> files:</p>
				<ul>
					<li>Use the following command to assign a file to a module.</li>
				</ul>
				<pre><code class="language-js"><span style="color: #008000">/**</span>
<span style="color: #008000"> * </span><span style="color: #0000FF">@packageDocumentation</span>
<span style="color: #008000"> * </span><span style="color: #0000FF">@module</span><span style="color: #008000"> </span><span style="color: #267F99">index</span>
<span style="color: #008000"> */</span>
</code></pre>
				<ul>
					<li>Use the following command to ignore a file:</li>
				</ul>
				<pre><code class="language-js"><span style="color: #008000">/** </span><span style="color: #0000FF">@ignore</span><span style="color: #008000"> */</span><span style="color: #000000"> </span><span style="color: #008000">/** */</span>
</code></pre>
				<ul>
					<li>Use the following command before any <code>export</code> to ignore it.</li>
				</ul>
				<pre><code class="language-js"><span style="color: #008000">/** </span><span style="color: #0000FF">@ignore</span><span style="color: #008000"> */</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">internallySharedFunction</span><span style="color: #000000">() {}</span>
</code></pre>
				<a href="#compiling-jsx" id="compiling-jsx" style="color: inherit; text-decoration: none;">
					<h2>Compiling JSX</h2>
				</a>
				<p>You can add JSX support by updating your <code>tsconfig.json</code> with following options:</p>
				<pre><code class="language-js"><span style="color: #000000">{</span>
<span style="color: #000000">  compilerOptions: {</span>
<span style="color: #000000">    </span><span style="color: #A31515">&quot;jsx&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;react&quot;</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#react" id="react" style="color: inherit; text-decoration: none;">
					<h3>React</h3>
				</a>
				<ul>
					<li>To compile React JSX components:</li>
				</ul>
				<ol>
					<li>Add <a href="https://reactjs.org/">react</a> to your dependencies: <code>npm install react</code></li>
				</ol>
				<a href="#preact" id="preact" style="color: inherit; text-decoration: none;">
					<h3>Preact</h3>
				</a>
				<ul>
					<li>To compile Preact JSX components:</li>
				</ul>
				<ol>
					<li>Add <a href="https://preactjs.com/">preact</a> to your dependencies: <code>npm install preact</code></li>
					<li>Update <code>compilerOptions</code> in <code>tsconfig.json</code>:</li>
				</ol>
				<pre><code class="language-js"><span style="color: #000000">{</span>
<span style="color: #000000">  </span><span style="color: #A31515">&quot;compilerOptions&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">    </span><span style="color: #A31515">&quot;lib&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> [</span><span style="color: #A31515">&quot;dom&quot;</span><span style="color: #000000">],</span>
<span style="color: #000000">    </span><span style="color: #A31515">&quot;jsxFactory&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;h&quot;</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#additional-targets" id="additional-targets" style="color: inherit; text-decoration: none;">
					<h2>Additional Targets</h2>
				</a>
				<p>If you need to compile your <code>src</code> to multiple targets, you can do this by:</p>
				<ol>
					<li>Make a copy of <code>tsconfig.json</code> for your target. ie: <code>tsconfig.es5.json</code></li>
					<li>Add a <code>npm scripts</code> to run <code>tsc</code> with <code>--build</code> option. ie: <code>tsc --build tsconfig.es5.json</code></li>
					<li>Update <code>build</code> script to have <code>xrun</code> run your new compile script. So if you named it <code>compile.es5</code>, your <code>build</code> would be: <code>xrun -n compile compile.es5</code></li>
				</ol>
				<ul>
					<li>In your additional target config, you don&#39;t need <code>tsc</code> to generate the <code>.d.ts</code> files. You can turn it off by setting <code>declaration</code> to <code>false</code></li>
				</ul>
				<a href="#license" id="license" style="color: inherit; text-decoration: none;">
					<h2>License</h2>
				</a>
				<p>Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a></p>
				<hr>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Modules</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/feature.html">feature</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/index.html">index</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/module_dev.html">module-<wbr>dev</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils.html">utils</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>